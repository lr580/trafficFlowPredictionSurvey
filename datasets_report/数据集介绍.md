## PeMS

PeMS（Caltrans **Pe**rformance **M**easurement **S**ystem）是研究最广泛的交通车流量预测数据集之一，由美国加利福尼亚州主要公路的超过 $39000$ 个探测器收集而来，并从 $2001$ 年开始持续不断收集数据至今。这些数据每半分钟收集一次，并将其聚合成 $5$ 分钟一个时间段或其他粒度的数据。截至 $2024$ 年 $10$ 月为止，共有 $19601$ 个站点的数据。

PeMS 涵盖的地理区域如下图所示。

![image-20241012161457479](img/image-20241012161457479.png)

在其官网（[http://pems.dot.ca.gov/](http://pems.dot.ca.gov/)）提供的原始数据里，以站点 $5$ 分钟（Station 5-Minute）数据为例（[网址](https://pems.dot.ca.gov/?dnode=Clearinghouse&type=station_5min&district_id=3&submit=Submit)），可以看到原始数据提供多种数据信息，包括时间戳（时间段的开始时刻，格式为 $24$ 小时制的 `MM/DD/YYYY HH:MI:SS`）、总流量、流量加权平均速度、平均占用率、车道类型、行驶方向、高速公路号等。

PeMS 数据集包含的站点和时间都比较庞大，所以研究者主要使用 PeMS 的一些代表性子集。可以看到，PeMS 数据列中既包含流量又包含速度，所以有一些子集，如 [PeMS-BAY](https://github.com/liyaguang/DCRNN) 是研究交通速度预测使用的。这里介绍一些研究交通流量预测的常用子集，它们是 PeMSD3、PeMSD4、PeMSD7、PeMSD8。值得注意的是，研究者也会把 D 写作 0，即例如 PeMSD4 又名为 PeMS04。在本文我们用前者来称呼。

这 $4$ 个数据集信息列表如下所示：

| 数据集名称 | 地点                                      | 时间跨度                 | 时间段数 | 探测器点数 | 边数  |
| ---------- | ----------------------------------------- | ------------------------ | -------- | ---------- | ----- |
| PeMSD3     | 中北部区域<br/>（North Central Area）     | $2018/9/1\sim2018/11/30$ | $26208$  | $358$      | $547$ |
| PeMSD4     | 旧金山湾区<br/>（San Francisco Bay Area） | $2018/1/1\sim2018/2/28$  | $16992$  | $307$      | $340$ |
| PeMSD7     | 洛杉矶区域<br/>（Los Angeles Area）       | $2017/5/1\sim2017/8/31$  | $28224$  | $883$      | $866$ |
| PeMSD8     | 圣贝纳迪诺区<br/>（San Bernardino Area）  | $2016/7/1\sim2016/8/31$  | $17856$  | $170$      | $277$ |

这几个数据子集可以从 [ASTGNN](https://github.com/guoshnBJTU/ASTGNN) 下载。这些数据集每个时间段收集了 $5$ 分钟的流量信息。它们的格式类似，下面以 PeMSD3 为例，展示该数据集的结构和数据样例。

每个子集由两部分数据构成，分别是：CSV 数据表示探测器构成的拓扑图结构，以及 NPZ 数据表示各节点的交通流量的时间序列。

CSV 数据由三列组成，其数据行数为上表所示的边数。有三列，分别为起点、终点和边权。边权代表两个探测器之间的距离代价。以 PeMSD8 为例，展示前 $5$ 个边节点。

| from | to   | cost  |
| ---- | ---- | ----- |
| 9    | 153  | 310.6 |
| 153  | 62   | 330.9 |
| 62   | 111  | 332.9 |
| 111  | 11   | 324.2 |
| 11   | 28   | 336.0 |

NPZ 数据由一个三维张量 `data` 组成，维度分别是时间段数，节点数和特征数。

- 对 PeMSD3/7，特征代表流量，即该时间段 $5$ 分钟内经过的车辆总数。
- 对 PeMSD4/8，有三个特征，分别是流量、数据、占用率。

以 PeMSD8 为例，展示前 $5$ 个时间段前 $5$ 个探测器节点的数据。

| 时间段编号<br/>\节点编号 | 0      | 1      | 2      | 3      | 4      |
| ------------------------ | ------ | ------ | ------ | ------ | ------ |
| 0                        | 133.00 | 210.00 | 124.00 | 145.00 | 206.00 |
| 1                        | 114.00 | 185.00 | 119.00 | 184.00 | 194.00 |
| 2                        | 140.00 | 171.00 | 107.00 | 146.00 | 162.00 |
| 3                        | 106.00 | 174.00 | 98.00  | 148.00 | 193.00 |
| 4                        | 117.00 | 176.00 | 114.00 | 130.00 | 163.00 |

除此之外，PeMS 还有一些其他子集，如 [PEMS-S](https://ojs.aaai.org/index.php/AAAI/article/view/5470)、[PEMS3-Stream](http://arxiv.org/abs/2106.06273)、[BayArea](http://arxiv.org/abs/2401.04148) 等。近年来 [LargeST](https://github.com/liuxu77/LargeST) 以 PeMS 为基础，整合了美国加州（CA）、大洛杉矶（GLA）、大湾区（GBA）和圣地亚哥（SD）的 $2017\sim2021$ 年的数据集，提供交通流量等特征数据。

## TaxiBJ

提供了中国北京超过 $34000$ 辆出租车在下面四个时间段每 $30$ 分钟一次共 $22459$ 个有效时间段的 GPS 轨迹数据：（1）$2013/7/1\sim2013/10/30$、（2）$2014/3/1\sim2014/6/30$、（3）$2015/3/1\sim2015/6/30$、（4）$2015/11/1\sim2016/4/10$。由 [Zhang 等人](https://ojs.aaai.org/index.php/AAAI/article/view/10735) 提出，将数据建模为了 $32\times32=1024$ 的网格节点，提供交通流量流入和流出数据。还提供了节假日信息、16 种天气状况、温度、风速的额外信息。许多研究者会使用该数据集的部分或全部来研究北京的出租车，也有研究者会用北京的其他数据集。

其中一个版本的数据子集可以在 [这里](https://github.com/Echo-Ji/ST-SSL_Dataset/tree/main/BJTaxi) 下载，提供了一个 $1024\times1024$ 的 01 矩阵代表这 $1024$ 个节点的邻接矩阵，以及划分为了 $7:1:2$ 的训练、验证、测试集状况。这三个集都由 $4$ 部分组成。含义如下：

1. $X$ 是输入数据，四维分别是 `(样本数, 回顾窗口, 点数, 流量类型)`，其中回顾窗口是 $35$，点数是 $1024$，类型是 $2$ 种（流入、流出），其中，回顾窗口代表前 $35$ 个时间点的数据。

2. $Y$ 是预测数据，四维是`(样本数, 预测窗口, 点数, 流量类型)`，其中预测窗口是 $1$，代表下 $1$ 个时间段的流量数据，其他维度与 $X$ 相似。

3. $X\_offsets$ 是回顾窗口偏移值，是 $35\times1$常量：`[[-147] [-146] [-145] [-144] [-143] [-142] [-141] [-140] [-139] [ -99] [ -98] [ -97] [ -96] [ -95] [ -94] [ -93] [ -92] [ -91] [ -51] [ -50] [ -49] [ -48] [ -47] [ -46] [ -45] [ -44] [ -43] [  -7] [  -6] [  -5] [  -4] [  -3] [  -2] [  -1] [   0]]`

   代表含义为：设 $o_i=X\_offsets[i][0]$，则 $X_{t,a,b,c}$ 的值与 $Y_{t+o_i+1,a,b,c}$ 相同，$+1$ 是因为 $Y_t$ 本来就是 $t$ 要预测的下一个时间点即第 $t+1$ 个时间点，即 $1=Y\_offsets[0][0]$。

4. $Y\_offsets$ 是预测窗口偏移值，是 $1\times1$ 常量：`[[1]]`

选取其中编号为 $100$ 的点(即下标第 $3$ 行第 $4$ 列的网格节点)，对该节点验证集的前 $5$ 个时间点的流量展示如下。

| 时间编号 | 0    | 1    | 2    | 3    | 4    |
| -------- | ---- | ---- | ---- | ---- | ---- |
| 流入流量 | 57.0 | 54.0 | 51.0 | 58.0 | 59.0 |
| 流出流量 | 55.0 | 53.0 | 50.0 | 59.0 | 58.0 |

## SHSpeed

上海市交通信息中心（**T**ransportation **I**nformation **C**enter）收集的 $2015/4/1\sim2015/4/30$ 的 $13573$ 辆出租车和 $65836$ 个路段的数据，每 $10$ 秒收集一次得来原始数据，包含位置、时间、载客状态、速度、行驶方向等。

[Wang 等人](http://arxiv.org/abs/1811.00740) 进一步预处理该数据，使用了密集交通的 $156$ 个节点。尽管这是一个交通速度的数据集，数据提出者仍能将其用于处理交通流量预测。

数据的包含空间信息如下：

1. `node.csv` 一共有 $22415$ 个点及其经纬度信息。
2. `segment.csv` 一共有 $66386$ 条边，不带边权，形成路网拓扑图。
3. `selSegs_1.csv` 选取的 $156$ 个点的编号。

原始道路节点与选取的道路节点（红色高亮）如下图所示：

![image-20241012224913326](img/image-20241012224913326.png)

利用上面空间信息，结合时间序列数据，共 $4320$ 个时间段的平均速度（km/h），下面输出前 $5$ 个选取节点的前 $5$ 个时间节点数据。

| 节点编号\时间编号 | 0           | 1           | 2           | 3           | 4           |
| ----------------- | ----------- | ----------- | ----------- | ----------- | ----------- |
| 758               | 29.39130435 | 18.69573060 | 15.50172372 | 16.06752614 | 15.17065686 |
| 759               | 23.22222222 | 17.10740741 | 17.37216611 | 18.52232377 | 18.60267935 |
| 762               | 22.25000000 | 26.83333333 | 29.91111111 | 25.43703704 | 22.64567901 |
| 763               | 32.33333333 | 32.27777778 | 37.46759259 | 38.66836420 | 35.26028807 |
| 764               | 21.88888889 | 25.43936093 | 25.37949947 | 25.76942220 | 23.12314073 |

经过统计，速度的统计特征如下：

| 统计特征  | 值                 |
| --------- | ------------------ |
| 最大值    | 93.00125449877395  |
| 最小值    | 0.6647310239137324 |
| 平均值    | 22.894674909586207 |
| 25%分位数 | 18.166155475839417 |
| 中位数    | 21.87063755708419  |
| 75%分位数 | 26.656185227312537 |



